{"version":3,"sources":["angularjs-gauge.js"],"names":["angular","gaugeMeterProviderFn","defaultOptions","size","value","undefined","cap","thick","type","foregroundColor","backgroundColor","duration","this","setOptions","customOptions","isObject","Error","merge","ngGauge","getOptions","extend","$get","gaugeMeterDirective","tpl","Gauge","element","options","find","text","legend","unit","context","getContext","init","prototype","setupStyles","create","canvas","width","height","lineCap","lineWidth","lfs","llh","css","display","fontWeight","position","textAlign","overflow","textOverflow","fontSize","lineHeight","textDecoration","opacity","fs","lh","parseInt","animate","requestID","window","requestAnimationFrame","head","tail","beginPath","newPos","movePerFrame","arc","center","x","y","radius","strokeStyle","stroke","cancelAnimationFrame","getType","bounds","getBounds","msecs","getDuration","getCenter","getValue","getRadius","getForegroundColor","distance","drawShell","Math","PI","start","end","clear","clearRect","getWidth","getHeight","update","destroy","getThickness","val","used","total","getBackgroundColor","getLineCap","restrict","replace","template","scope","append","label","prepend","link","watchData","nv","ov","gauge","equals","watchOther","defaults","isDefined","$watch","$on","module","directive","provider","$inject"],"mappings":"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","file":"angularjs-gauge.min.js","sourcesContent":["(function (angular) {\n    'use strict';\n    angular\n        .module('angularjs-gauge', [])\n        .directive('ngGauge', gaugeMeterDirective)\n        .provider('ngGauge', gaugeMeterProviderFn);\n\n    gaugeMeterProviderFn.$inject = [];\n    function gaugeMeterProviderFn() {\n        var defaultOptions = {\n            size: 200,\n            value: undefined,\n            cap: 'butt',\n            thick: 2,\n            type: 'full',\n            foregroundColor: '#FFCC66',\n            backgroundColor: '#CCC',\n            duration: 1500\n        };\n\n        this.setOptions = function (customOptions) {\n            if (!(customOptions && angular.isObject(customOptions)))\n                throw new Error('Invalid option type specified in the ngGaugeProvider');\n            defaultOptions = angular.merge(defaultOptions, customOptions);\n        };\n\n        var ngGauge = {\n            getOptions: function () {\n                return angular.extend({}, defaultOptions);\n            }\n        };\n\n        this.$get = function () {\n            return ngGauge;\n\n        };\n\n    }\n\n    gaugeMeterDirective.$inject = ['ngGauge'];\n\n    function gaugeMeterDirective(ngGauge) {\n\n        var tpl = '<div style=\"display:inline;text-align:center;position:relative;\"><span><u>{{prepend}}</u>{{value}}<u>{{append}}</u></span><b>{{label}}</b><canvas></canvas></div>';\n\n        var Gauge = function (element, options) {\n            this.element = element.find('canvas')[0];\n            this.text = element.find('span');\n            this.legend = element.find('b');\n            this.unit = element.find('u');\n            this.context = this.element.getContext('2d');\n            this.options = options;\n            this.init();\n        };\n\n        Gauge.prototype = {\n\n            init: function () {\n                this.setupStyles();\n                this.create();\n            },\n\n            setupStyles: function () {\n\n                this.context.canvas.width = this.options.size;\n                this.context.canvas.height = this.options.size;\n                this.context.lineCap = this.options.cap;\n                this.context.lineWidth = this.options.thick;\n\n                var lfs = this.options.size * 0.22,\n                    llh = this.options.size;\n\n                this.text.css({\n                    display: 'inline-block',\n                    fontWeight: 100,\n                    width: '100%',\n                    position: 'absolute',\n                    textAlign: 'center',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    fontSize: lfs + 'px',\n                    lineHeight: llh + 'px'\n                });\n\n                this.unit.css({\n                    textDecoration: 'none',\n                    fontSize: '0.6em',\n                    fontWeight: 200,\n                    opacity: 0.8\n                });\n\n                var fs = this.options.size / 13;\n                var lh = (5 * fs) + parseInt(this.options.size);\n\n                this.legend.css({\n                    display: 'inline-block',\n                    width: '100%',\n                    position: 'absolute',\n                    textAlign: 'center',\n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    fontWeight: 200,\n                    fontSize: fs + 'px',\n                    lineHeight: lh + 'px'\n                });\n            },\n            create: function () {\n\n                var type = this.getType(),\n                    bounds = this.getBounds(type),\n                    msecs = this.getDuration(),\n                    movePerFrame = 40 / msecs,\n                    center = this.getCenter(),\n                    context = this.context,\n                    value = this.getValue(),\n                    radius = this.getRadius(),\n                    foregroundColor = this.getForegroundColor(),\n                    requestID,\n                    head = bounds.head,\n                    tail = bounds.tail,\n                    distance = tail - head;\n\n                this.drawShell(head, tail);\n                tail = head + (distance * value) / 100;\n\n                function animate() {\n                    requestID = window.requestAnimationFrame(animate);\n\n                    if (head <= tail) {\n                        context.beginPath();\n                        var newPos = head + 2 * movePerFrame;\n                        context.arc(center.x, center.y, radius, head, newPos, false);\n                        context.strokeStyle = foregroundColor;\n                        context.stroke();\n                        head = newPos;\n                    } else {\n                        cancelAnimationFrame(requestID);\n                    }\n                }\n                animate();\n            },\n\n            getBounds: function (type) {\n                var head, tail;\n                if (type == 'semi') {\n                    head = Math.PI;\n                    tail = 2 * Math.PI;\n                } else if (type == 'full') {\n                    head = 1.5 * Math.PI;\n                    tail = 3.5 * Math.PI;\n                } else if (type === 'arch') {\n                    head = 0.8 * Math.PI;\n                    tail = 2.2 * Math.PI;\n                }\n\n                return {\n                    head: head,\n                    tail: tail\n                };\n\n            },\n\n            drawShell: function (start, end) {\n                var context = this.context,\n                    center = this.getCenter(),\n                    radius = this.getRadius();\n                context.beginPath();\n                context.arc(center.x, center.y, radius, start, end, false);\n                context.strokeStyle = this.options.backgroundColor;\n                context.stroke();\n            },\n\n            clear: function () {\n                this.context.clearRect(0, 0, this.getWidth(), this.getHeight());\n            },\n\n            update: function () {\n                this.clear();\n                this.create();\n            },\n\n            destroy: function () {\n                this.clear();\n            },\n\n            getRadius: function () {\n                var center = this.getCenter();\n                return center.x - this.getThickness();\n            },\n\n            getCenter: function () {\n                var x = this.getWidth() / 2,\n                    y = this.getHeight() / 2;\n                return {\n                    x: x,\n                    y: y\n                };\n            },\n\n            getValue: function () {\n                var val = 0;\n                if (this.options.used && this.options.total) {\n                    val = (this.options.used / this.options.total) * 100;\n                    this.options.value = this.options.used;\n                } else {\n                    val = this.options.value;\n                }\n                return val;\n\n            },\n            getWidth: function () {\n                return this.context.canvas.width;\n            },\n\n            getHeight: function () {\n                return this.context.canvas.height;\n            },\n\n            getThickness: function () {\n                return this.options.thick;\n            },\n\n            getBackgroundColor: function () {\n                return this.options.backgroundColor;\n            },\n\n            getForegroundColor: function () {\n                return this.options.foregroundColor;\n            },\n\n            getLineCap: function () {\n                return this.options.cap;\n            },\n\n            getType: function () {\n                return this.options.type;\n            },\n\n            getDuration: function () {\n              return this.options.duration;\n            }\n\n        };\n\n\n        return {\n            restrict: 'E',\n            replace: true,\n            template: tpl,\n            scope: {\n                append: '@?',\n                backgroundColor: '@?',\n                cap: '@?',\n                foregroundColor: '@?',\n                label: '@?',\n                prepend: '@?',\n                size: '@?',\n                thick: '@?',\n                type: '@?',\n                duration: '@?',\n                value: '=?',\n                used: '=?',\n                total: '=?'\n\n            },\n            link: function (scope, element) {\n                var defaults = ngGauge.getOptions(); // fetching default settings from provider\n                scope.value = angular.isDefined(scope.value) ? scope.value : defaults.value;\n                scope.size = angular.isDefined(scope.size) ? scope.size : defaults.size;\n                scope.cap = angular.isDefined(scope.cap) ? scope.cap : defaults.cap;\n                scope.thick = angular.isDefined(scope.thick) ? scope.thick : defaults.thick;\n                scope.type = angular.isDefined(scope.type) ? scope.type : defaults.type;\n                scope.duration = angular.isDefined(scope.duration) ? scope.duration : defaults.duration;\n                scope.foregroundColor = angular.isDefined(scope.foregroundColor) ? scope.foregroundColor : defaults.foregroundColor;\n                scope.backgroundColor = angular.isDefined(scope.backgroundColor) ? scope.backgroundColor : defaults.backgroundColor;\n\n                var gauge = new Gauge(element, scope);\n\n                scope.$watch('value', watchData, false);\n                scope.$watch('used', watchData, false);\n                scope.$watch('total', watchData, false);\n                scope.$watch('cap', watchOther, false);\n                scope.$watch('thick', watchOther, false);\n                scope.$watch('type', watchOther, false);\n                scope.$watch('size', watchOther, false);\n                scope.$watch('duration', watchOther, false);\n                scope.$watch('foregroundColor', watchOther, false);\n                scope.$watch('backgroundColor', watchOther, false);\n\n                scope.$on('$destroy', function () { });\n                scope.$on('$resize', function () { });\n\n                function watchData(nv, ov) {\n                    if (!gauge) return;\n                    if (!nv || angular.equals(nv, ov)) return;\n                    gauge.update();\n                }\n\n                function watchOther(nv, ov) {\n                    if (!gauge) return;\n                    if (!nv || angular.equals(nv, ov)) return;\n                    gauge.destroy();\n                    gauge.init();\n                }\n            }\n        };\n\n    }\n}(angular));\n"]}